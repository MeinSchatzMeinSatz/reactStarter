# JSX란?

프런트엔드 개발자가 JSX를 가장 먼저 접하게 되는 계기는 대부분 리액트를 배우는 과정이다. 리액트를 통해 JSX를 접하기 때문에 JSX가 리액트의 전유물이라고 오해하는 경우가 있다. 이는 반은 맞고 반은 틀리다. JSX는 리액트가 등장하면서 페이스북에서 소개한 새로운 구문이지만 반드시 리액트에서만 사용하라는 법은 없다. JSX는 흔히 개발자들이 알고 있는 XML과 유사한 내장형 구문이며, 리액트에 종속적이지 않은 독자적인 문법으로 보는 것이 옳다. 그리고 페이스북에서 독자적으로 개발했다는 사실에서 미루어 알 수 있듯이 JSX는 이른바 ECMAScript라고 불리는 자바스크립트 표준의 일부는 아니다. 즉, V8이나 Deno와 같은 자바스크립트 엔진이나 크롬, 웨일 파이어폭스 같은 브라우저에 의해서 실행되거나 표현되도록 만들어진 구문이 아니다. 따라서 다음과 같은 코드를 바로 실행하면 실행되지 않고 에러가 발생한다.

JSX가 포함된 코드를 아무런 처리 없이 그대로 실행하면 에러가 발생한다. 앞서 언급했던 것처럼 JSX는 자바스크립트 표준 코드가 아닌 페이스북이 임의로 만든 새로운 문법이기 때문에 JSX는 반드시 트랜스파일러를 거쳐야 비로소 자바스크립트 런타임이 이해할 수 있는 의미 있는 자바스크립트 코드로 변환된다. (JSX가 트랜스파일을 거쳐 자바스크립트 코드로 변환되는 과정은 이후에 살펴보자.)

JSX는 HTML이나 XML을 자바스크립트 내부에 표현하는 것이 유일한 목적은 아니다. JSX의 설계 목적은 다양한 트랜스파일러에서 다양한 속성을 가진 트리 구조를 토큰화해 ECMAScript로 변환하는 데 초점을 두고 있다. 조금 더 쉽게 이야기하자면 JSX내부에 트리 구조로 표현하고 싶은 다양한 것들을 작성해 두고, 이 JSX를 트랜스파일이라는 과정을 거쳐 자바스크립트(ECMAScript)가 이해할 수 있는 코드로 변경하는 것이 목표라고 볼 수 있다.

즉, JSX가 사용되는 곳은 리액트 내부에서 반환하는 HTML과 자바스크립트 코드이지만 꼭 그것에 한정돼 있는 것은 아니다. 즉, JSX는 HTML, XML 외에도 다른 구문으로도 확장될 수 있게끔 고려돼 있으며 최대한 구문을 간결하고 친숙하게 작성할 수 있도록 설계돼 있다. XML과 비슷하게 보이는 것은 단순히 자바스크립트 개발자로 하여금 친숙감을 느낄 수 있도록 하는 것이다.

요약하자면 JSX는 자바스크립트 내부에서 표현하기 까다로웠던 XML 스타일의 트리 구문을 작성하는 데 많은 도움을 주는 새로운 문법이라고 볼 수 있다. 이제 본격적으로 JSX가 어떻게 구성돼 있고 자바스크립트가 이를 이해하기 위해 어떤 과정을 거쳐야 하는지 살펴보자.

## JSX의 정의

JSX는 기본적으로 JSXElement, JSXAttributes, JSXChildren, JSXStirngs 라는 4가지 컴포넌트를 기반으로 구성돼 있다. 각 컴포넌트에 대해 살펴보자.

### JSXElement

JSX를 구성하는 가장 기본 요소.
HTML의 요소와 비슷한 역할을 한다. JSXElement가 되기 위해서는 다음과 같은 형태 중 하나여야 한다.

-   JSXOpeningElement: 일반적으로 볼 수 있는 요소다. JSXOpeningElement로 시작했다면 후술할 JSXClosingElement가 동일한 요소로 같은 단계에서 선언돼 있어야 올바른 JSX문법으로 간주 된다.
-   JSXClosingElement: JSXOpeningElement가 종료됐음을 알리는 요소로, 반드시 JSXOpeningElement와 쌍으로 사용돼야 한다.
-   JSXSelfClosingElement: 요소가 시작되고, 스스로 종료되는 형태를 의미한다.
-   JSXFragment: 아무런 요소가 없는 형태로 JSXSelfClosingElement 형태를 띌 수는 없다.

*   요소명은 대문자로 시작해야만 하는 거 아닌가?

-   리액트에서 HTML 구문 이외에 사용자가 컴포넌트를 만들어 사용할 때에는 반드시 대문자로 시작하는 컴포넌트를 만들어야만 사용 가능하다. 이는 JSXElement에 명시돼 있는 표준에는 없는 내용이다. 그 이유는 리액트에서 HTML 태그명과 사용자가 만든 컴포넌트 태그명을 구분 짓기 위해서다.

textarea, a, span과 같이 현존하는 HTML 태그만 필터링해 처리하지 않고 위와 같은 규칙을 둔 이유는 미래에 추가되는 HTML에 대한 가능성을 열어두고 사람이 확실하게 구별할 수 있는 차이점을 두기 위한 것으로 보인다.

### JSXElementName

JSXElement의 요소 이름으로 쓸 수 있는 것을 의미한다. 이름으로 가능한 것은 다음과 같다.

-   JSXIdentifier: JSX 내부에서 사용할 수 있는 식별자를 의미한다. 이는 자바스크립트 식별자 규칙과 동일한다. 즉, <$></$> <_></_> 도 가능하지만 자바스크립트와 마찬가지로 $와 \_ 왜의 다른 특수 문자로는 시작할 수 없다.
-   JSXNamespacedName: JSXIdentifier:JSXIdentifier의 조합, 즉 : 을 통해 서로 다른 식별자를 이어주는 것도 하나의 식별자로 취급된다. : 로 묶을 수 있는 것은 한 개 뿐이다. 두 개 이상은 올바른 식별자로 취급되지 않는다.
-   JSXMemberExpression: JSXIdentifier.JSXIdentifier의 조합. 즉 .을 통해 서로 다른 식별자를 이어주는 것도 하나의 식별자로 취급된다. :로 묶는 JSXNamespacedName과는 다르게 .을 여러 개 이어서 하는 것도 가능하다. 단 JSXNamedspacedName과 이어서 사용하는 것은 불가능하다.

### JSXAttributes

JSXElement에 부여할 수 있는 속성을 의미한다. 단순히 속성을 의미하기 때문에 모든 경우에 필수값이 아니고, 존재하지 않아도 에러가 나지 않는다.

-   JSXSpreadAttributes: 자바스크립트의 전개 연산자와 동일한 역할을 한다고 볼 수 있다.
    -   {...AssignmentExpression} : 이 AssignmentExpression에는 단순히 객체 뿐만 아니라 자바스크립트에서 AssignmentExpression으로 취급되는 모든 표현식이 존재할 수 있다. 여기에는 조건문 표현식, 화살표 함수, 할당식 등 다양한 것이 포함된다.
-   JSXAttribute: 속성을 나타내는 키와 값으로 짝을 이루어서 표현한다. 키는 JSXAttributeName, 값은 JSXAttributeValue로 불린다.
    -   JSXAttributeName: 속성의 키 값. 키로는 앞서 JSXElementName에서 언급했던 JSXIdentifier와 JSXNamespacedName이 가능하다. 여기서도 마찬가지로 : 를 이용해 키를 나타낼 수 있다.
-   JSXAttributeValue: 속성의 키에 할당할 수 있는 값으로, 다음 중 하나를 만족해야 한다.
    -   "큰따옴표로 구성된 문자열" 자바스크립트의 문자열과 동일하다. 안에 아무런 내용이 없어도 상관없다.
    -   '작은 따옴표로 구성된 문자열' 자바스크립트의 문자열과 동일하다. 안에 아무런 내용이 없어도 상관없다.
    -   {AssingmentExpression}: 자바스크립트의 AssignmentExpression을 의미한다. AssigmentExpression은 자바스크립트에서 값을 할당할 때 쓰는 표현식을 말한다. 즉, 자바스크립트에서 변수에 값을 넣을 수 있는 JSX 속성의 값으로도 가능하다.
    -   JSXElement: 값으로 다른 JSX 요소가 들어갈 수 있다. 리액트에서 자주 볼 수 없는 코드지만 다음과 같은 형태도 가능하다.
    -   대부분의 리액트 개발자들은 <Child attribute={<div>hello</div>}> 와 같이 값으로 들어가는 리액트 컴포넌트를 {}로 감싸는 걸 보는 것이 더 익숙할 텐데, 사실 이것은 문법적인 오류가 아닌 prettier의 규칙이다.
    -   JSXFragment: 값으로 별도 속성을 갖지 않는 형태의 JSX 요소가 들어갈 수 있다. 즉, 비어 있는 형태의 <></>가 허용된다.

### JSXChildren

JSXElement의 자식 값을 나타낸다. JSX는 앞서 언급했듯 속성을 가진 트리 구조를 나타내기 위해 만들어졌기 때문에 JSX로 부모와 자식 관계를 나타낼 수 있으며, 그 자식을 JSXChildren 이라고 한다.

-   JSXChild: JSXChildren을 이루는 기본 단위다. 단어의 차이에서 알 수 있듯이 jSXChildren은 JSXChild를 0개 이상 가질 수 있다. 0개 이상이라는 의미에서 알 수 있는 JSXChildrendms JSXChild가 없어도 상관없다.
    -   JSXText: {, <, >, }을 제외한 문자열. 이는 다른 JSX 문법과 혼동을 줄 수 있기 때문이다. 만약 이 문자를 표현하고 싶다면 문자열로 표시하는 방법이 있다.
    -   JSXElement: 값으로 다른 JSX요소가 들어갈 수 있다.
    -   JSXFragment: 값으로 빈 JSX요소인 <></>가 들어갈 수 있다.
    -   {JSXChildExpression (optional)}: 이 JSXChildExpression은 자바스크립트의 AssignmentExpression을 의미한다. 익숙하지 않겠지만 다음과 같은 코드도 올바른 JSX 표현식으로 볼 수 있다.

### JSXStrings

앞서 소개한 JSXAttributeValue와 JSXText는 HTML과 JSX 사이에 복사와 붙여넣기를 쉽게 할 수 있도록 설계돼 있다. HTML에서 사용 가능한 문자열은 모두 JSXStirngs에서도 가능하다. 이는 개발자가 HTML의 내용을 손쉽게 JSX로 가져올 수 있도록 의도적으로 설계된 부분이다. 여기서 정의된 문자열이라 함은, "큰따옴표로 구성된 문자열", "작은 따옴표로 구성된 문자열" 혹은 JSXText를 의미한다.

따라서 자바스크립트와는 한 가지 중요한 차이점이 발생하는데 바로 \로 시작하는 이스케이프 문자 형태소다. \는 자바스크립트에서 특수문자를 처리할 때 사용되므로 몇 가지 제약 사항이 있지만 HTML에선 아무런 제약 없이 사용할 수 있다.

## JSX는 어떻게 자바스크립트에서 변환될까? (... 일단 이해 안되니 넘어가 본다.)

우선 자바스크립트에서 JSX가 변환되는 방식을 알려면 리액트에서 JSX를 변환하는 @babel/plugin-transform-react-jsx 플러그인을 알아야 한다. 이 플러그인은 JSX 구문을 자바스크립트가 이해할 수 있는 형태로 변환한다.

다음과 같은 JSX코드가 있다고 가정해 보자.

## 정리

지금까지 실제 JSX 공식 문서를 기준으로 JSX의 상세한 스펙을 살펴봤다. JSX를 리액트 외에 사용해 본 적이 없다면 몇 가지 특이한 문법도 봤을 것이다. 이는 리액트에서 JSX의 모든 구문을 다 활용할 필요가 없다고 판단했기 때문일 것이다. JSX 문법에는 있지만 실제로 리액트에서 사용하지 않는 것은 다음과 같다.

-   JSXNamespacedName
-   JSXMemberExpression

Preact, SolidJS, Nano JSX 등 다양한 라이브러리도 JSX를 채용하고 있으며, 이 라이브러리들은 리액트와는 다르게 JSXNameSpacedName, JSXExpression을 목적이 따라 사용할 수도 있으므로 반드시 이러한 스펙도 JSX 문법임을 알아둬야 한다.

이처럼 JSX는 자바스크립트 코드 내부에 HTML과 같은 트리 구조를 가진 컴포넌트를 표현할 수 있다는 점에서 각광받고 있다. 물론 인기만 있는 것은 아니다. JSX가 HTML 문법과 자바스크립트의 문법이 뒤섞여서 코드 가독성을 해친다는 의견도 있다. JSX 내부에 자바스크립트 문법이 많아질수록 복잡성이 증대하면서 코드 가독성도 해칠 것이므로 주의해서 사용해야 한다.

그리고 적어도 리액트 내부에서 JSX가 어떻게 변환되는지, 그리고 어떤 결과물을 만들어내는지 알아두면 향후에 리액트 애플리케이션을 만드는 데 도움이 될 수 있다. JSX는 물로 대부분의 경우 편리하고 간결하게 컴포넌트를 작성하는 데 많은 도움을 주지만 앞선 예제처럼 때에 따라서는 직접 createElement를 사용해 컴포넌트를 구성하는 편이 더 효율적일 수 있다. 이러한 JSX에 대한 깊은 이해도는 나아가 리액트와 비슷한 기반의 또 다른 애플리케이션을 만드는 데 도움이 될 것이다.
